# Real-time Chat (Go)

> Bilingual README: **Russian** first, then **English**.

---

## üá∑üá∫ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

Real-time Chat / Messaging Platform ‚Äî —ç—Ç–æ —É—á–µ–±–Ω—ã–π, –Ω–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω—ã–π –∫ production backend-–ø—Ä–æ–µ–∫—Ç –Ω–∞ Go –¥–ª—è –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç:

- —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤—ã–≤–∞—Ç—å—Å—è;
- —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–º–Ω–∞—Ç—ã (channels / rooms);
- –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –∫–æ–º–Ω–∞—Ç–∞–º –ø–æ WebSocket;
- –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∏ –ø–æ–ª—É—á–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ –ø–æ–ª–Ω–æ–≥–æ —Å—Ç–µ–∫–∞:

- backend –Ω–∞ Go;
- —Ä–∞–±–æ—Ç–∞ —Å WebSocket –∏ REST;
- Postgres –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ;
- Redis –∫–∞–∫ –∫—ç—à –∏ –º–µ—Ö–∞–Ω–∏–∑–º pub/sub;
- –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è (Docker) –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è (Kubernetes);
- –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏ (Prometheus + Grafana);
- CI/CD (GitLab CI –∏–ª–∏ GitHub Actions).

---

## üá∑üá∫ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (JWT).
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç–∞–º–∏ (—á–∞—Ç-–∫–∞–Ω–∞–ª–∞–º–∏).
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ –ø–æ WebSocket.
- –û–±–º–µ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (broadcast –ø–æ –∫–æ–º–Ω–∞—Ç–µ).
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Postgres.
- –ö—ç—à –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏/–∏–ª–∏ –æ–Ω–ª–∞–π–Ω-—Å—Ç–∞—Ç—É—Å–∞ –≤ Redis.
- –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
  - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö WebSocket-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π;
  - RPS –ø–æ REST API;
  - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö/–ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π;
  - –æ—à–∏–±–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é –≤ Kubernetes.

---

## üá∑üá∫ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–≤ –æ–±—â–∏—Ö —á–µ—Ä—Ç–∞—Ö)

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

- **API / Gateway (Go)**  
  –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç HTTP REST –∑–∞–ø—Ä–æ—Å—ã (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, CRUD –ø–æ –∫–æ–º–Ω–∞—Ç–∞–º) –∏ WebSocket-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç).

- **Chat Hub (Go)**  
  –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç:
  - –∫–æ–º–Ω–∞—Ç–∞–º–∏ (rooms);
  - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤;
  - —à–∏—Ä–æ–∫–æ–≤–µ—â–∞—Ç–µ–ª—å–Ω—ã–º –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–æ–º–Ω–∞—Ç—É.

- **PostgreSQL**  
  –û—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ:
  - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏;
  - –∫–æ–º–Ω–∞—Ç—ã;
  - —Å–æ–æ–±—â–µ–Ω–∏—è;
  - –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞).

- **Redis**  
  –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:
  - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (–ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –æ–Ω–ª–∞–π–Ω-—Å—Ç–∞—Ç—É—Å—ã);
  - pub/sub –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏ —Å–µ—Ä–≤–∏—Å–∞ –≤ Kubernetes.

- **Prometheus + Grafana**  
  –°–±–æ—Ä –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (HTTP, WebSocket, DB/Redis).

- **Kubernetes**  
  –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–µ—Ä–≤–∏—Å—ã, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è.

---

## üá∑üá∫ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

**–Ø–∑—ã–∫ –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏**

- Go 1.21+ / 1.22
- HTTP —Ä–æ—É—Ç–µ—Ä: `github.com/go-chi/chi/v5`
- WebSocket: `github.com/gorilla/websocket` (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ nhooyr/websocket)
- JWT: –ª—é–±–∞—è Go-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä `github.com/golang-jwt/jwt/v5`

**–î–∞–Ω–Ω—ã–µ –∏ –∫—ç—à**

- PostgreSQL
- Redis (`github.com/redis/go-redis/v9`)
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –ë–î: `golang-migrate` –∏–ª–∏ –∞–Ω–∞–ª–æ–≥

**–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**

- Docker, docker-compose
- Kubernetes (minikube, k3s, kind –∏–ª–∏ –ª—é–±–æ–π managed-–∫–ª–∞—Å—Ç–µ—Ä)
- Helm (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**Observability**

- Prometheus (`github.com/prometheus/client_golang`)
- Grafana
- –õ–æ–≥–∏ –≤ stdout (–º–æ–∂–Ω–æ –ø—Ä–∏–∫—Ä—É—Ç–∏—Ç—å Loki/Elastic)

**CI/CD**

- GitLab CI (`.gitlab-ci.yml`) –∏–ª–∏
- GitHub Actions (`.github/workflows/ci.yml`)

---

## üá∑üá∫ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
realtime-chat/
  cmd/
    api/
      main.go              # –≤—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞ HTTP + WebSocket —Å–µ—Ä–≤–µ—Ä–∞
  internal/
    http/
      router.go            # chi router, middlewares
      handlers.go          # REST-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (auth, rooms, etc.)
      ws_handler.go        # upgrade –¥–æ WebSocket, –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
    chat/
      hub.go               # —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π "hub" –¥–ª—è –∫–æ–º–Ω–∞—Ç –∏ –∫–ª–∏–µ–Ω—Ç–æ–≤
      room.go              # –ª–æ–≥–∏–∫–∞ –∫–æ–º–Ω–∞—Ç—ã (broadcast, join/leave)
      client.go            # —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞ (connection, send/recv)
    storage/
      postgres/
        repo.go            # —Ä–∞–±–æ—Ç–∞ —Å Postgres
      redis/
        cache.go           # –∫—ç—à, pub/sub
    auth/
      jwt.go               # –≥–µ–Ω–µ—Ä–∞—Ü–∏—è/–≤–∞–ª–∏–¥–∞—Ü–∏—è JWT
      middleware.go        # middleware –¥–ª—è HTTP-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    config/
      config.go            # —á—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ env/—Ñ–∞–π–ª–∞
    metrics/
      metrics.go           # Prometheus –º–µ—Ç—Ä–∏–∫–∏ –∏ /metrics handler
    logger/
      logger.go            # –ª–æ–≥–≥–µ—Ä (zap/logrus/slog)
  deployments/
    docker/
      Dockerfile
      docker-compose.yml
    k8s/
      configmap.yaml
      deployment.yaml
      service.yaml
      ingress.yaml
  .gitlab-ci.yml
  go.mod
  go.sum
  README.md

